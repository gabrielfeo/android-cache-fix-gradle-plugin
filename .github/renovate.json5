{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  // See https://docs.renovatebot.com/modules/manager/regex/
  // Dependabot is used for all other updates.
  "enabledManagers": ["regex"],
  "customManagers": [
    {
      // Matches AGP versions annotated with a "renovate: AGP version" comment
      customType: "regex",
      fileMatch: [
        "src/main/resources/versions\\.json5",
        "gradle\\.properties",
      ],
      matchStrings: [
        // For JSON: the first double-quoted string below the comment line, e.g. "1.0.0"
        "\/\/ renovate: AGP version\\s+?\"(?<currentValue>\\S+?)\"",
        // For properties: the value of the first property below the comment line, e.g. anyProperty=1.0.0
        "# renovate: AGP version\\s+?\\S+?=(?<currentValue>\\S+?)(?:\\s|$)",
      ],
      "datasourceTemplate": "maven",
      "versioningTemplate": "maven",
      "depNameTemplate": "com.android.tools.build:gradle",
      "registryUrlTemplate": "https://dl.google.com/dl/android/maven2/",
    },
  ],
  "packageRules": [
    {
      // In versions.json5, only allow bumps within current major/minor
      // New major/minor releases must be added manually as new properties.
      "matchDepNames": ["com.android.tools.build:gradle"],
      "matchFileNames": ["src/main/resources/versions\\.json5"],
      // e.g. for 8.6.2, allow only 8.6.x bumps
      "allowedVersions": "/^{{{replace '(\\d+)\\.(\\d+)\\.' '$1\\.$2\\.' currentVersion}}}.*$/"
    },
  ],
}
